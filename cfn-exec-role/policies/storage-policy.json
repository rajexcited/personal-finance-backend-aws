{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "VisualEditor0",
      "Effect": "Allow",
      "Action": ["dynamodb:ListTables", "dynamodb:DescribeLimits", "dynamodb:DescribeEndpoints", "dynamodb:ListStreams"],
      "Resource": "*"
    },
    {
      "Sid": "VisualEditor1",
      "Effect": "Allow",
      "Action": [
        "dynamodb:DeleteResourcePolicy",
        "dynamodb:PutResourcePolicy",
        "dynamodb:DescribeStream",
        "dynamodb:GetResourcePolicy",
        "dynamodb:DescribeBackup",
        "dynamodb:DeleteBackup"
      ],
      "Resource": [
        "arn:aws:dynamodb:*:${aws:PrincipalAccount}:table/*${aws:PrincipalTag/appId}-${aws:PrincipalTag/environment}*/stream/*",
        "arn:aws:dynamodb:*:${aws:PrincipalAccount}:table/*${aws:PrincipalTag/appId}-${aws:PrincipalTag/environment}*/backup/*"
      ]
    },
    {
      "Sid": "VisualEditor2",
      "Effect": "Allow",
      "Action": [
        "s3:DeleteObjectTagging",
        "s3:GetBucketTagging",
        "s3:DeleteObjectVersion",
        "s3:GetObjectAttributes",
        "s3:RestoreObject",
        "s3:PutObjectVersionTagging",
        "s3:ListBucket",
        "s3:DeleteObjectVersionTagging",
        "s3:GetObjectVersionAttributes",
        "s3:ListTagsForResource",
        "s3:PutObject",
        "s3:GetObject",
        "s3:GetObjectTagging",
        "s3:PutObjectTagging",
        "s3:DeleteObject",
        "s3:GetObjectVersion",
        "s3:PutLifecycleConfiguration"
      ],
      "Resource": "*",
      "Condition": {
        "StringEquals": {
          "aws:ResourceTag/environment": "${aws:PrincipalTag/environment}",
          "aws:ResourceTag/appId": "${aws:PrincipalTag/appId}"
        }
      }
    },
    {
      "Sid": "VisualEditor3",
      "Effect": "Allow",
      "Action": [
        "dynamodb:UpdateTimeToLive",
        "dynamodb:UntagResource",
        "dynamodb:PutResourcePolicy",
        "dynamodb:ListTagsOfResource",
        "dynamodb:StartAwsBackupJob",
        "dynamodb:CreateBackup",
        "dynamodb:DescribeTimeToLive",
        "dynamodb:DeleteTable",
        "dynamodb:DescribeContinuousBackups",
        "dynamodb:UpdateContinuousBackups",
        "dynamodb:CreateTable",
        "dynamodb:DeleteResourcePolicy",
        "dynamodb:TagResource",
        "dynamodb:DescribeTable",
        "dynamodb:GetResourcePolicy",
        "dynamodb:UpdateTable"
      ],
      "Resource": ["arn:aws:dynamodb:*:${aws:PrincipalAccount}:table/*${aws:PrincipalTag/appId}-${aws:PrincipalTag/environment}*"]
    },
    {
      "Sid": "VisualEditor4",
      "Effect": "Allow",
      "Action": [
        "s3:CreateBucket",
        "s3:DeleteBucket",
        "s3:DeleteBucketPolicy",
        "s3:PutBucketTagging",
        "s3:PutBucketPolicy",
        "s3:GetBucketPolicyStatus",
        "s3:GetBucketPolicy"
      ],
      "Resource": [
        "arn:aws:s3:::*${aws:PrincipalTag/appId}-${aws:PrincipalTag/environment}*",
        "arn:aws:s3:::*${aws:PrincipalTag/appId}-${aws:PrincipalTag/environment}*/*"
      ]
    }
  ]
}
